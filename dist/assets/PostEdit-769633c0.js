var V=(x,b,d)=>new Promise((n,_)=>{var m=a=>{try{t(d.next(a))}catch(f){_(f)}},u=a=>{try{t(d.throw(a))}catch(f){_(f)}},t=a=>a.done?n(a.value):Promise.resolve(a.value).then(m,u);t((d=d.apply(x,b)).next())});import{ak as j,aj as I,r as q,h as N,j as F,a8 as p,ac as M,m as B,q as $,t as C,H as r,B as s,C as z,A,u as H,F as k}from"./vue-vendor-003ac6f9.js";import{Q as D,P as i,U as O}from"./element-plus-ec987f8a.js";import{s as w}from"./supabase-6fa7b02d.js";import{_ as Q}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-e40cfe8c.js";const S={class:"post-edit"},T={class:"page-header"},G={__name:"PostEdit",setup(x){const b=j(),d=I(),n=q(!1),_=q(),m=b.params.id,u=!!m,t=N({title:"",author:"",content:""}),a={title:[{required:!0,message:"ËØ∑ËæìÂÖ•ÊñáÁ´†Ê†áÈ¢ò",trigger:"blur"}],author:[{required:!0,message:"ËØ∑ËæìÂÖ•‰ΩúËÄÖÂêçÁß∞",trigger:"blur"}],content:[{required:!0,message:"ËØ∑ËæìÂÖ•ÊñáÁ´†ÂÜÖÂÆπ",trigger:"blur"}]},f=()=>V(this,null,function*(){if(u)try{n.value=!0;const{data:o,error:e}=yield w.from("posts").select("*").eq("id",m).single();if(e){console.error("Ëé∑ÂèñÊñáÁ´†Êï∞ÊçÆÂ§±Ë¥•:",e),i.error("Ëé∑ÂèñÊñáÁ´†Êï∞ÊçÆÂ§±Ë¥•");return}Object.assign(t,{title:o.title||"",author:o.author||o.author_name||"",content:o.content||""})}catch(o){console.error("Âä†ËΩΩÊñáÁ´†Êï∞ÊçÆÂ§±Ë¥•:",o),i.error("Âä†ËΩΩÊñáÁ´†Êï∞ÊçÆÂ§±Ë¥•")}finally{n.value=!1}}),E=()=>V(this,null,function*(){try{yield _.value.validate(),n.value=!0;const o={title:t.title,author:t.author,content:t.content};console.log("üìù ÂáÜÂ§á‰øùÂ≠òÊñáÁ´†Êï∞ÊçÆ:",o);let e;if(u){console.log("üîÑ ÂºÄÂßãÊõ¥Êñ∞ÊñáÁ´†ÔºåID:",m);const{data:c,error:l}=yield w.from("posts").update(o).eq("id",m).select();if(l){console.error("‚ùå Êõ¥Êñ∞ÊñáÁ´†Â§±Ë¥•:",l),i.error(`Êõ¥Êñ∞Â§±Ë¥•: ${l.message}`);return}console.log("‚úÖ Êõ¥Êñ∞ÊàêÂäü:",c),e=c,i.success("ÊñáÁ´†Êõ¥Êñ∞ÊàêÂäü")}else{console.log("‚ûï ÂºÄÂßãÂàõÂª∫Êñ∞ÊñáÁ´†");const{data:c,error:l}=yield w.from("posts").insert([o]).select();if(l){console.error("‚ùå ÂàõÂª∫ÊñáÁ´†Â§±Ë¥•:",l),i.error(`ÂàõÂª∫Â§±Ë¥•: ${l.message}`);return}console.log("‚úÖ ÂàõÂª∫ÊàêÂäü:",c),e=c,i.success("ÊñáÁ´†ÂàõÂª∫ÊàêÂäü")}h()}catch(o){console.error("‰øùÂ≠òÊñáÁ´†Â§±Ë¥•:",o),i.error("‰øùÂ≠òÊñáÁ´†Â§±Ë¥•ÔºåËØ∑Ê£ÄÊü•Ë°®ÂçïÊï∞ÊçÆ")}finally{n.value=!1}}),h=()=>{d.push("/posts")};return F(()=>{u&&f()}),(o,e)=>{const c=p("el-icon"),l=p("el-button"),y=p("el-input"),v=p("el-form-item"),P=p("el-form"),R=p("el-card"),U=M("loading");return B(),$("div",S,[C("div",T,[r(l,{onClick:h,type:"primary",size:"small"},{default:s(()=>[r(c,null,{default:s(()=>[r(H(O))]),_:1}),e[3]||(e[3]=k(" ËøîÂõû ",-1))]),_:1}),C("h2",null,D(u?"ÁºñËæëÊñáÁ´†":"Êñ∞Âª∫ÊñáÁ´†"),1)]),z((B(),A(R,null,{default:s(()=>[r(P,{model:t,rules:a,ref_key:"formRef",ref:_,"label-width":"80px"},{default:s(()=>[r(v,{label:"Ê†áÈ¢ò",prop:"title"},{default:s(()=>[r(y,{modelValue:t.title,"onUpdate:modelValue":e[0]||(e[0]=g=>t.title=g),placeholder:"ËØ∑ËæìÂÖ•ÊñáÁ´†Ê†áÈ¢ò"},null,8,["modelValue"])]),_:1}),r(v,{label:"‰ΩúËÄÖ",prop:"author"},{default:s(()=>[r(y,{modelValue:t.author,"onUpdate:modelValue":e[1]||(e[1]=g=>t.author=g),placeholder:"ËØ∑ËæìÂÖ•‰ΩúËÄÖÂêçÁß∞"},null,8,["modelValue"])]),_:1}),r(v,{label:"ÂÜÖÂÆπ",prop:"content"},{default:s(()=>[r(y,{modelValue:t.content,"onUpdate:modelValue":e[2]||(e[2]=g=>t.content=g),type:"textarea",rows:10,placeholder:"ËØ∑ËæìÂÖ•ÊñáÁ´†ÂÜÖÂÆπ"},null,8,["modelValue"])]),_:1}),r(v,null,{default:s(()=>[r(l,{type:"primary",onClick:E},{default:s(()=>[k(D(u?"Êõ¥Êñ∞":"ÂàõÂª∫"),1)]),_:1}),r(l,{onClick:h},{default:s(()=>[...e[4]||(e[4]=[k("ÂèñÊ∂à",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})),[[U,n.value]])])}}},Z=Q(G,[["__scopeId","data-v-857b304b"]]);export{Z as default};
